# v00.01 - mwt-g

-----------------------------------------------------------
## AI INSTRUCTIONS

1. Only execute tasks marked with `[R]`.
  - `[ ]` indicates backlog (not yet ready to implement).
  - `[R]` indicates ready to implement in the current session.
  - `[I]` indicates the AI has implemented the code; set this once the work is completed in this session.
  - `[x]` indicates the user has signed off on the implementation.
1. Feature tracking is done using the format `Feature-00[ ]`
  - `[ ]` means that the feature has not been implemented.
  - `[I]` means that the feature is implemented. The AI shall annotate the feature description with the version that it was implemented in.
  - `[x]` is the human sign-off
1. Only mark a task or feature as done AFTER tests have passed
1. Do not excecute features without at least three tests to verify the implementation.

The prompt to execute the sequence will be
```
Review prompt v00.01.md and execute all implementation tasks marked with [R]
```

-----------------------------------------------------------
## APPLICATION SPECIFICATION

This section describes the application; it is not for execution purposes.

### Overview

mwt-g is a command-line tool for creating and launching URL aliases. It can be used within a project or installed globally.

### Features

- Custom URL scheme: `g:/<alias>` → `https://www.google.com/` (example)
- Settings are stored in:
  - A JSON file
  - Searched in the following order (first match wins):
    - Project-local: `./mwt-g/settings.json`
    - User-level: `~/.config/mwt-g/settings.json`

### Usage
- Feature-01[ ]: Adding an alias
  ```
  g g https://www.google.com
  ```


- Feature-02[ ]: Visiting the alias
  ```
  g y
  ```
  - Opens the user's default browser to `https://www.yahoo.com/`

- Feature-03[ ]: Adding an alias smartly
  ```
  g y yahoo
  ```
  - `y` is the alias name
  - If the second parameter is a bare keyword (no scheme), it resolves to `https://www.<param2>.com`

- Feature-04[ ]: Deep links
  ```
  g yn yahoo/news
  ```
  - `yn` is the alias name
  - Expands to `https://www.<param2>.com/news` → `https://www.yahoo.com/news`

- Feature-05[ ]: List aliases
  ```
  g +list
  ```
  - Lists all known aliases

- Feature-06[ ]: Choose navigation end-points
  ```
  g +b yn
  ```
  - `+b` will launch the URL into the registered browser.
  - `+c` will launch using Curl 
  - `+n` will display the URL for the user to click on.

- Feature-07[ ]: Register URL scheme
  ```
  g +register
  ```
  - Registers the custom `g:/` URL scheme with the OS so links like `g:/y` open via this tool

-----------------------------------------------------------
## Technical requirements

### MANDATORY

1. Only use PowerShell 7 for all scripting, whether it's the app or the tests.
2. The directory tree is $PROJECT_ROOT/mwt-g.
    - Create the following directories 
        - $PROJECT_ROOT/mwt-g/bin
        - $PROJECT_ROOT/mwt-g/tests
    - A separate promotion script will later move necessary content to the parent directory.

### Build Tool instructions
1. Build the tool using PowerShell 7, which should be available everywhere — Windows, macOS, and Linux.
1. Create the tool using best practices for portability — use Context7 to ensure that the most current documentation and best practices are adhered to.
1. Create the script as `mwt-g.ps1` in the `bin/` directory for this project.



-----------------------------------------------------------
## APPLICATION IMPLEMENTATION

### ALWAYS ###
- Maintain a `README.md` for the tool.
- Always write a test and always run the test after each session sequence.
- Only mark a task as `[I]` after the tests have been executed and passed.
- Perform syntax validation as a standard test.
- Maintain an application history prompts/HISTORY.md during each session
  - Note any tasks executed.
  - Note results of all tests.
  - Generate a commit message.
  - Summarize features.

### v00.01.01 
Create the initial version of the application as follows:

1. [I] Implement the ability to add a basic URL (`g g https://www.google.com`). [Feature-01] Implemented in v00.01.01
   - [I] add `+overwrite-alias` with `always`,`never`,`ask` options. Implemented in v00.01.01
   - [I] add `+quiet` to supress any messages. Implemented in v00.01.01
   - [I] app should display what it's doing (and why, if there are flags involved.) Implemented in v00.01.01
1. [I] Implement `+n` (display URL) and make it the default. [Feature-06] Implemented in v00.01.01
1. [I] Implement alias listing with `+list`. [Feature-05] Implemented in v00.01.01
 1. [I] Rework the files:
       - [I] All configurations should be in configuration.toml (defaults respected by tool)
       - [I] All `+` options should be stored with defaults
           - [I] +overwrite-alias always
       - [I] Move the aliases to aliases.toml
        - [I] Create the configuration.toml file if it doesn't exist. Implemented in v00.01.01
1. [I] Implement tests using Pester
      - [I] `mwt-g g https://www.google.com` should add the alias to the settings file.
      - [I] `mwt-g g` should display https://www.google.com
      - [I] `mwt-g gg` throws an error
      - [I] `mwt-g +list` should list all the aliases added 
      - [I] `mwt-g g https://www.google2.com` should overwrite the alias
       - [I] `mwt-g +quiet` should output nothing.
       - [I] `mwt-g +overwrite-alias never g https://www.google3.com` should refuse to overwrite the alias `g`.
       - [I] `mwt-g +overwrite-alias always g https://www.google3.com` should overwrite the alias `g`.
       - [I] Test that the configuration file exists. Implemented in v00.01.01



### v00.01.02
1. [ ] Implement `+c` (fetch via curl). [Feature-06]

### v00.01.03
1. [ ] Implement `+b` (open in browser). [Feature-06]

### v00.01.04
1. [ ] Implement smart URL handling. [Feature-03]
1. [ ] Implement deep links. [Feature-04]

### Future
1. [ ] Implement visiting an alias baseline behavior (apply default action). [Feature-02]
1. [ ] Implement OS URL handler registration with `+register`. [Feature-07]


-----------------------------------------------------------
# IGNORE BELOW #



- Implement command line completions.
- Add long parameter names
- Add man page
- What other things should we be doing to make this a proper command line tool?
- Update settings handling
  - settings.json -> should contain application settings.
  - aliases should be in aliases.json or aliases.yaml
- mwt-g xxx -> instead of throwing an error should prompt for the URL. (or paste it from the copy-buffer)
- note when aliases were added or updated.